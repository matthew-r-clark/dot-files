# in the terminal <C-,> is mapped to send <C-b> (0x02)

# Set default shell
set -g default-command $SHELL

# Automatically set window title
setw -g automatic-rename off
set -g set-titles on

# Start window panes at 1, instead of 0
set -g base-index 1
setw -g pane-base-index 1

# Variables {{{

SEP_L=""
SEP_R=""

CL1_PRI="#[fg=colour27,bg=colour255,bold]"
CL1_SEC="#[fg=colour255,bg=colour27]"
CL1_SEC_NO_EXP="fg=colour255,bg=colour27"

CL1_TSA="#[fg=colour27,bg=colour81]"
CL1_TSB="#[fg=colour81,bg=colour159]"
CL1_TSC="#[fg=colour27,bg=colour159]"
CL1_TSD="#[fg=colour81,bg=colour27]"
CL1_TSE="#[fg=colour159,bg=colour81]"

CL2_PRI="#[fg=colour237,bg=colour255]"
CL2_SEC="#[fg=colour255,bg=colour237]"

CL2_TSA="#[fg=colour237,bg=colour245]"
CL2_TSB="#[fg=colour245,bg=colour255]"
CL2_TSC="#[fg=colour237,bg=colour255]"
CL2_TSD="#[fg=colour245,bg=colour159]"
CL2_TSE="#[fg=colour237,bg=colour245]"

CL1_TS1="${CL2_TSA}${SEP_L}${CL2_TSB}${SEP_L}${CL2_TSC}"
CL1_TS2="${CL1_TSD}${SEP_R}${CL1_TSE}${SEP_R}${CL1_TSC}"
CL2_TS1="${CL1_TSA}${SEP_L}${CL1_TSB}${SEP_L}${CL1_TSC}"
CL2_TS2="${CL2_TSD}${SEP_R}${CL2_TSE}${SEP_R}${CL2_SEC}"

# }}}

# Status Window format
setw -g window-status-current-format "${CL2_SEC} #I ${CL1_TS1} #W* "
setw -g window-status-format "${CL1_SEC} #I ${CL2_TS1} #W "

# Status Window styling {{{

set -g status on
set -g status-interval 1
set -g status-justify "left"
set -g status-left-length 60
set -g status-right-length 90
set -g status-style "${CL1_SEC_NO_EXP}"
set -g status-left-style "${CL1_SEC_NO_EXP}"
set -g status-right-style "${CL1_SEC_NO_EXP}"
set -g status-left ""
set -g status-right "#{prefix_highlight} ${CL1_TS2} #{pane_current_path} ${CL2_TS2} %m/%d/%Y %r "

setw -g window-status-style "${CL1_SEC_NO_EXP}"
setw -g window-status-separator ""
setw -g window-status-current-style "${CL1_SEC_NO_EXP}"
setw -g window-status-activity-style "${CL1_SEC_NO_EXP}"
setw -g window-status-bell-style "${CL1_SEC_NO_EXP}"
setw -g window-status-last-style "${CL1_SEC_NO_EXP}"

# }}}

# Window Styling
set -g window-style 'fg=colour247,bg=colour236'
set -g window-active-style 'fg=colour250,bg=colour0'

# Pane Styling
set -g pane-border-style bg=colour235,fg=colour238
set -g pane-active-border-style bg=colour236,fg=colour51

set -g message-command-style "${CL1_SEC_NO_EXP}"
set -g message-style "${CL1_SEC_NO_EXP}"
set -g mode-style "${CL1_SEC_NO_EXP}"

# General Settings
set -g history-limit 10000
setw -g monitor-activity off
set -g visual-activity on
set -g visual-bell off
set -g visual-silence on
set -g bell-action none

# Split Panes
bind-key h split-window -h -c "#{pane_current_path}"
bind-key v split-window -v -c "#{pane_current_path}"

bind -n C-i select-pane -U
bind -n C-k select-pane -D
bind -n C-j select-pane -L
bind -n C-l select-pane -R

bind -n C-Up resize-pane -U 5
bind -n C-Left resize-pane -L 5
bind -n C-Down resize-pane -D 5
bind -n C-Right resize-pane -R 5

bind -T root C-e send-keys C-l

# Automatically renumber window numbers on closing a pane
set -g renumber-windows on

# Don't wrap searches
set -w -g wrap-search off

# Restore neovim sessions
set -g @resurrect-strategy-nvim 'session'
set -g @resurrect-capture-pane-contents 'off'

# Default terminal
set -g default-terminal 'screen-256color'
set -ga terminal-overrides '*:Ss=\E[%p1%d q:Se=\E[ q'

# Ensure FocusGained and FocusLost events work
set -g focus-events on

# Plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-copycat'

set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
set -g @prefix_highlight_fg '255'
set -g @prefix_highlight_bg '27'
set -g @prefix_highlight_prefix_prompt '--Prefix--'

set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @continuum-restore 'on' # Restore session when starting tmux
set -g @continuum-save-interval '1' # minutes (default is 15)

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
# Note: This won't run unless you've already executed: git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
# run -b '~/.tmux/plugins/tpm/tpm'
